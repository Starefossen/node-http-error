box: node:latest

build:
    steps:
        - script:
            name: echo nodejs information
            code: |
                echo "node version $(node -v) running"
                echo "npm version $(npm -v) running"

        - npm-install

        - script:
            name: lint
            code: npm run lint

        - npm-test

    after-steps:
        - turistforeningen/slack-notifier:
            url: $SLACK_WEBHOOK_URL

deploy:
    steps:
        - script:
            name: semantic release pre
            code: npm run semantic-release -- pre

        - script:
            name: npm dedupe
            code: npm dedupe

        - turistforeningen/npm-publish

        - script:
            name: semantic release post
            code: npm run semantic-release -- post

    after-steps:
        - turistforeningen/slack-notifier:
            url: $SLACK_WEBHOOK_URL
